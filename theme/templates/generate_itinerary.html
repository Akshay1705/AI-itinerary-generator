{% extends 'base.html' %}

{% block content %}
<div class="min-h-screen bg-gray-100 flex items-center justify-center p-6">
  <div class="bg-white shadow-xl rounded-2xl w-full max-w-6xl grid grid-cols-1 md:grid-cols-2 overflow-hidden">

    <!-- Left Side - Form -->
    <div class="p-8 bg-gray-50">
      <h2 class="text-2xl font-bold text-gray-800 mb-6">Generate Travel Itinerary</h2>
      <form method="post" class="space-y-5">
        {% csrf_token %}

        <!-- Destination -->
        <div>
          <label class="block text-gray-700 font-medium mb-2">Destination</label>
          <input type="text" name="destination"
            class="w-full p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:outline-none" required>
        </div>

        <!-- Start Date -->
        <div>
          <label class="block text-gray-700 font-medium mb-2">Start Date</label>
          <input type="date" name="start_date"
            class="w-full p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:outline-none" required>
        </div>

        <!-- Number of Days -->
        <div>
          <label class="block text-gray-700 font-medium mb-2">Number of Days</label>
          <input type="number" name="days" min="1"
            class="w-full p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:outline-none" required>
        </div>

        <!-- Budget -->
        <div>
          <label class="block text-gray-700 font-medium mb-2">Budget</label>
          <select name="budget"
            class="w-full p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:outline-none">
            <option value="low">Low ($)</option>
            <option value="medium">Medium ($$)</option>
            <option value="high">High ($$$)</option>
          </select>
        </div>

        <!-- Interests -->
        <div>
          <label class="block text-gray-700 font-medium mb-2">Interests</label>
          <select name="interests"
            class="w-full p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:outline-none">
            <option value="adventure">Adventure</option>
            <option value="culture">Culture</option>
            <option value="relaxation">Relaxation</option>
          </select>
        </div>

        <!-- Submit -->
        <button type="submit"
          class="w-full py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition">
          Generate
        </button>
      </form>
    </div>

    <!-- Right Side - Output -->
    <div class="p-8 flex flex-col">
      <h2 class="text-2xl font-bold text-gray-800 mb-6">Your Itinerary</h2>
      <div class="flex-1 bg-gray-100 rounded-xl p-6 overflow-y-auto max-h-[60vh] relative" id="itineraryOutput">

        <!-- ðŸ”„ Loading Spinner -->
        <div id="loadingSpinner" class="hidden absolute inset-0 flex items-center justify-center bg-gray-100 bg-opacity-75">
          <div class="w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"></div>
        </div>

        {% if itinerary_days %}
          <div class="space-y-4">
            <h3 class="text-lg font-semibold text-indigo-600 mb-3">
              Generated Itinerary for {{ destination }}
            </h3>
            <p class="text-sm text-gray-700">
              <strong>Duration:</strong> {{ days }} days <br>
              <strong>Budget:</strong> {{ budget }} <br>
              <strong>Interests:</strong> {{ interests }}
            </p>
            {% for day in itinerary_days %}
              <div class="p-5 bg-white rounded-xl shadow border border-gray-200">
                <h4 class="font-bold text-gray-800 mb-2">
                  {{ day|linebreaksbr }}
                </h4>
              </div>
            {% endfor %}
          </div>

          <!-- ðŸ“Œ Action Buttons -->
          <div class="flex justify-end gap-3 mt-4">
            <button id="zoomBtn" 
              class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition">
              Zoom
            </button>
            <button id="downloadPdfBtn" 
              class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition">
              Download PDF
            </button>
          </div>

        {% else %}
          <p class="text-gray-500 italic">Your generated itinerary will appear here.</p>
        {% endif %}
      </div>
    </div>

  </div>
</div>

<!-- ðŸ”¹ Fullscreen Modal for Zoom (Place here at the end) -->
<div id="itineraryModal" class="fixed inset-0 bg-black bg-opacity-80 hidden items-center justify-center z-50 p-6">
  <div class="bg-white w-full max-w-4xl rounded-xl p-6 relative overflow-y-auto max-h-[90vh]">
    <button id="closeModal" class="absolute top-4 right-4 text-white bg-red-600 px-3 py-1 rounded-lg hover:bg-red-700">Close</button>
    <div id="modalContent"></div>
  </div>
</div>

{% endblock %}
